{"openapi":"3.0.3","info":{"title":"Holusion Controller","version":"3.0.1"},"paths":{"/system/version":{"parameters":[],"get":{"tags":["system"],"summary":"get controller's version","operationId":"getSystemVersion","parameters":[],"responses":{"200":{"description":"the product's controller version","content":{"text/plain":{"schema":{"type":"string"}},"application/json":{"schema":{"type":"object","required":["version"],"properties":{"version":{"type":"string"}}}}}}}}},"/system/service/uptime":{"parameters":[],"get":{"tags":["system"],"summary":"get service uptime in seconds","operationId":"getSystemServiceUptime","parameters":[],"responses":{"200":{"description":"the service's uptime in seconds","content":{"text/plain":{"schema":{"type":"string","example":"12345"}},"application/json":{"schema":{"type":"object","items":{"$ref":"#/components/schemas/ConfKey"},"example":{"value":12345}}}}}}}},"/system/service/exit":{"parameters":[],"put":{"tags":["system"],"summary":"gracefully exit node service","operationId":"putSystemServiceExit","parameters":[],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/system/screenshot":{"parameters":[],"get":{"tags":["system"],"summary":"get an image of system's screen","operationId":"getSystemScreenshot","parameters":[],"responses":{"200":{"description":"the product's screen as a PNG","content":{"image/png":{"schema":{"type":"string","format":"binary"}}}},"500":{"$ref":"#/components/responses/Error500"}}}},"/system/screens":{"parameters":[],"get":{"tags":["system"],"summary":"get screens configuration","operationId":"getSystemScreens","parameters":[],"responses":{"200":{"description":"the product's xrandr output","content":{"text/plain":{"schema":{"$ref":"#/components/schemas/ScreenConfText"}},"application/json":{"schema":{"$ref":"#/components/schemas/ScreenConf"}}}},"500":{"$ref":"#/components/responses/Error500"}}},"put":{"tags":["system"],"summary":"set screens configuration","operationId":"setSystemScreens","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ScreenConf"}},"text/plain":{"schema":{"$ref":"#/components/schemas/XrandrCommand"}}}},"responses":{"200":{"description":"standard 200 OK response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"400":{"$ref":"#/components/responses/Error400"},"500":{"$ref":"#/components/responses/Error500"}}}},"/system/mimeapps":{"parameters":[],"get":{"tags":["system"],"summary":"get default apps associated to mime types, as per","operationId":"getSystemMimeapps","parameters":[],"responses":{"200":{"description":"the product's mimeapps.list as raw text","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Mimeapps"}},"text/plain":{"schema":{"type":"string","example":"[Default Applications]\nvideo/mp4=com.holusion.player.desktop\n"}}}}}},"put":{"tags":["system"],"summary":"set default apps associated to mime types","operationId":"setSystemMimeapps","parameters":[],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Mimeapps"}},"text/plain":{"schema":{"type":"string","example":"[Default Applications]\nvideo/mp4=com.holusion.player.desktop\n"}}}},"responses":{"200":{"description":"A status message","content":{"text/plain":{"schema":{"type":"string","example":"OK"}},"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/system/logs":{"parameters":[],"get":{"tags":["system"],"summary":"get system logs for controller","operationId":"getSystemLogs","parameters":[],"responses":{"200":{"description":"Daily-rotated logs","content":{"text/plain":{"schema":{"type":"string"}},"application/json":{"schema":{"type":"array","items":{"type":"object","required":["@timestamp","@version","message","severity"],"properties":{"@timestamp":{"type":"string","format":"date-time"},"@version":{"type":"string"},"message":{"type":"string"},"severity":{"type":"string","enum":["emerg","alert","crit","err","warning","notice","info","debug"]},"programname":{"type":"string"},"facility":{"type":"string"}}}}}}},"500":{"$ref":"#/components/responses/Error500"}}}},"/system/ip":{"parameters":[],"get":{"tags":["system"],"summary":"get hostname","operationId":"getSystemHostname","parameters":[],"responses":{"200":{"description":"the product's given name","content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"array","items":{"type":"object","properties":{"address":{"type":"string","example":"192.168.1.10"},"netmask":{"type":"string","example":"255.0.0.0"},"family":{"type":"string","example":"IPv4"},"mac":{"type":"string","example":"00:00:00:00:00:00"},"internal":{"type":"boolean"},"cidr":{"type":"string","example":"192.168.1.10/8"}}}}}}}}}}},"/system/hostname":{"parameters":[],"get":{"tags":["system"],"summary":"get hostname","operationId":"getSystemHostname","parameters":[],"responses":{"200":{"description":"the product's given name","content":{"text/plain":{"schema":{"type":"string"}},"application/json":{"schema":{"type":"object","items":{"$ref":"#/components/schemas/ConfKey"}}}}}}}},"/playlist/":{"parameters":[],"get":{"tags":["playlist"],"summary":"get full playlist","description":"Returns all playlist items. Can be polled on websocket","operationId":"getPlaylist","parameters":[],"responses":{"200":{"description":"all playlist items","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Playlist"}}}}}},"put":{"tags":["playlist"],"summary":"update a playlist element","description":"update a set of  elements using a modifier and a query  object as in a <a href=\"https://github.com/louischatriot/nedb\">nedb</a> update function","operationId":"putPlaylist","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["query","modifier"],"properties":{"query":{"type":"object","properties":{"name":{"type":"string","example":"foo.mp4"}}},"modifier":{"type":"object","additionalProperties":true,"properties":{"$set":{"type":"object","properties":{"active":{"type":"boolean","example":false}}}}}}}}}},"responses":{"200":{"description":"all playlist items","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/medias/":{"parameters":[],"post":{"tags":["medias"],"summary":"create a new media","description":"add a file or folder and fill defaults for it in db as a \"POST /playlist\" would have done","operationId":"uploadFile","requestBody":{"content":{"multipart/form-data":{"schema":{"oneOf":[{"type":"object","properties":{"file":{"type":"string","format":"binary"}},"required":["file"]},{"type":"object","properties":{"files":{"type":"array","items":{"type":"string","format":"binary"}}},"required":["files"]},{"type":"object","properties":{"uri":{"type":"string"}},"required":["uri"]}]}},"application/json":{"schema":{"type":"object","properties":{"uri":{"type":"string"}},"required":["uri"]}}}},"responses":{"200":{"description":"the created playlist item","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PlaylistItem"}}}}},"400":{"description":"unique constraint Violated or invalid data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"$ref":"#/components/responses/Error500"}}}},"/control/pause":{"parameters":[],"post":{"tags":["control"],"summary":"toggle pause","description":"Send a pause command to current player. Caution : there is no programmatic way to know play/pause state afterwards","parameters":[],"responses":{"200":{"description":"standard 200 OK response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"$ref":"#/components/responses/Error500"}}}},"/control/current/":{"parameters":[],"get":{"tags":["control"],"summary":"get currently played element","description":"Return the playlist element currently played on screen","operationId":"getControlCurrent","parameters":[],"responses":{"200":{"description":"currently played item","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlaylistItem"}}}}}},"put":{"tags":["control"],"summary":"set currently played element","description":"Send an object query identifying uniquely the playlist item the engine should be playing now.\n      Object query can have a combination of most of PlaylistItem's properties, but should match only one item","operationId":"setControlCurrent","parameters":[],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string"},"rank":{"type":"number"},"start":{"type":"string"},"_id":{"type":"string"}}}}}},"responses":{"200":{"description":"currently played item","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlaylistItem"}}}}}}},"/config/":{"parameters":[],"get":{"tags":["config"],"summary":"get all configuration keys and values","operationId":"getConfigKeys","parameters":[],"responses":{"200":{"description":"an array of key/value objects","content":{"application/json":{"schema":{"type":"object","items":{"$ref":"#/components/schemas/ConfKey"}}}}}}}},"/playlist/{name}":{"parameters":[],"get":{"tags":["playlist"],"summary":"Get a playlist item","description":"Returns a playlist item defined by \"name\"","operationId":"getPlaylistByName","parameters":[{"name":"name","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"The playlist item matching {name}","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlaylistItem"}}}},"400":{"description":"Invalid name provided","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"$ref":"#/components/responses/Error404"}}},"put":{"tags":["playlist"],"summary":"update a playlist element","description":"update a playlist element based on it's name.","operationId":"getPlaylist","parameters":[{"name":"name","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/PlaylistItem"},{"$ref":"#/components/schemas/NeDbModifier"}]}}}},"responses":{"200":{"description":"the updated playlist item","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlaylistItem"}}}},"400":{"description":"invalid data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"item not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/medias/{name}":{"parameters":[],"delete":{"tags":["medias"],"summary":"delete a file or URL media","description":"delete a file from system. Also remove it from database","operationId":"deleteFile","parameters":[{"name":"name","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"File and database entry were deleted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"$ref":"#/components/responses/Error404"},"500":{"$ref":"#/components/responses/Error500"}}},"get":{"tags":["medias"],"summary":"get a media file","description":"get a media file or its corresponding thumbnail","operationId":"getFile","parameters":[{"name":"name","in":"path","required":true,"schema":{"type":"string"}},{"name":"thumb","in":"query","required":false,"schema":{"type":"boolean"}}],"responses":{"200":{"description":"The requested file as a download ressource","content":{"application/octet-stream":{"schema":{"type":"string","format":"binary"}},"video/mp4":{"schema":{"type":"string","format":"binary"}},"image/png":{"schema":{"type":"string","format":"binary"}}}},"404":{"$ref":"#/components/responses/Error404"},"500":{"$ref":"#/components/responses/Error500"}}}},"/control/current/{name}":{"parameters":[],"put":{"tags":["control"],"summary":"set currently played element using its name","description":"Send an element's name to play it immediately","operationId":"setControlCurrent","parameters":[{"name":"name","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"currently played item","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlaylistItem"}}}}}}},"/config/{key}":{"parameters":[],"get":{"tags":["config"],"summary":"get a configuration value","operationId":"getConfigKey","parameters":[{"in":"path","name":"key","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"the value associated with this key","content":{"application/json":{"schema":{"type":"object","items":{"$ref":"#/components/schemas/ConfKey"}}}}},"404":{"description":"the requested property does not exist","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}},"put":{"tags":["config"],"summary":"set a configuration key","operationId":"setConfigKey","parameters":[{"in":"path","name":"key","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["value"],"properties":{"value":{"description":"The requested value","example":"<foo>"}}}},"text/plain":{"schema":{"type":"string"}}}},"responses":{"200":{"description":"the value associated with this key","content":{"application/json":{"schema":{"type":"object","items":{"$ref":"#/components/schemas/ConfKey"}}}}},"403":{"description":"the requested property is not modifiable","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"the requested property does not exist","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}}},"components":{"schemas":{"Error":{"type":"object","required":["code","message"],"properties":{"code":{"type":"integer","description":"HTTP status code"},"message":{"type":"string","description":"Status text"}}},"ConfKey":{"type":"object","required":["value"],"properties":{"value":{"description":"The requested value","example":true}}},"NeDbModifier":{"type":"object","additionalProperties":{"type":"object"}},"PlaylistItem":{"type":"object","required":["name","active","rank"],"additionalProperties":true,"properties":{"name":{"type":"string","description":"Name of the element. unique-indexed"},"active":{"type":"boolean","description":"Whether the item is active or not"},"rank":{"type":"integer","description":"rank of the object. 2 equals ranks are supported and items are then sorted according to their names"},"conf":{"type":"array","description":"An object of specific parameters given to controller app in background","items":{"type":"string"}}}},"Playlist":{"type":"array","items":{"$ref":"#/components/schemas/PlaylistItem"}},"ScreenConf":{"type":"object","required":["screens"],"properties":{"info":{"type":"object","properties":{"maxWidth":{"type":"number"},"maxHeight":{"type":"number"}}},"screens":{"type":"array","items":{"type":"object","required":["name"],"properties":{"name":{"type":"string"},"connected":{"type":"boolean"},"rotate":{"type":"string","enum":["normal","inverted","left","right"]},"reflect":{"type":"string","enum":["normal","xy","x","y"]},"width":{"type":"number","example":640},"height":{"type":"number","example":480},"x":{"type":"number","example":0},"y":{"type":"number","example":0},"modes":{"type":"array","items":{"type":"object","required":["name"],"properties":{"name":{"type":"string","example":"640x480"},"width":{"type":"number","example":640},"height":{"type":"number","example":480},"rate":{"type":"number","example":60},"current":{"type":"boolean"}}}}}}}}},"ScreenConfText":{"type":"string","example":"Screen 0: minimum 8 x 8, current 3840 x 1080, maximum 16384 x 16384\n    DVI-D-0 connected 1920x1080+0+0 (normal left inverted right x axis y axis) 477mm x 268mm\n       1920x1080     60.00*+  59.94    50.00    60.05    60.00    50.04  \n       1680x1050     59.95  \n    HDMI-0 connected primary 1920x1080+1920+0 (normal left inverted right x axis y axis) 477mm x 268mm\n       1920x1080     60.00*+  59.94    50.00    60.05    60.00    50.04  \n       1680x1050     59.95  \n    "},"XrandrCommand":{"type":"string","example":"xrandr --output HDMI-0 --auto --reflect x"},"Mimedict":{"type":"object","properties":{"video/mp4":{"type":"string","example":"mpv.desktop"}},"additionalProperties":{"type":"string"}},"Mimeapps":{"type":"object","properties":{"Added Associations":{"$ref":"#/components/schemas/Mimedict"},"Removed Associations":{"$ref":"#/components/schemas/Mimedict"},"Default Applications":{"$ref":"#/components/schemas/Mimedict"}}}},"responses":{"Error404":{"description":"404 : Ressource not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"Error400":{"description":"400: invalid request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"Error500":{"description":"500 : Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}},"tags":[{"name":"system"},{"name":"playlist"},{"name":"medias"},{"name":"control"},{"name":"config"}]}